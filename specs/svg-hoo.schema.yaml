# SVG-HOO Schema v1.0: Frozen Perfect Core
# Higher-Order Operators in SVG Normal Form

version: "1.0"
frozen: true
description: "Canonical SVG-HOO operator definitions with Normal Form chain"

# Normal Form Chain (immutable order)
normal_form_chain:
  - name: "Stencil"
    stage: 1
    purpose: "Initial shape definition"
    contracts: ["local_geometry", "boundary_preservation"]
    
  - name: "Quantize2" 
    stage: 2
    purpose: "2-level quantization"
    contracts: ["discrete_levels", "monotone_mapping"]
    
  - name: "AA"
    stage: 3
    purpose: "Anti-aliasing smoothing"
    contracts: ["continuity", "local_smoothness"]
    
  - name: "Partition2"
    stage: 4
    purpose: "Dual partitioning"
    contracts: ["partition_completeness", "disjoint_coverage"]
    
  - name: "Band3"
    stage: 5
    purpose: "3-band frequency separation"
    contracts: ["frequency_isolation", "band_preservation"]
    
  - name: "Gradientize"
    stage: 6
    purpose: "Gradient field generation"
    contracts: ["smooth_gradients", "vector_field_consistency"]
    
  - name: "BlueNoise"
    stage: 7
    purpose: "Blue noise dithering"
    contracts: ["noise_distribution", "spatial_frequency_control"]
    
  - name: "Spectralize"
    stage: 8
    purpose: "Spectral finalization"
    contracts: ["spectral_completeness", "final_form"]

# Operator Attributes (frozen)
operator_attributes:
  idempotent: true
  local_contracts: true
  stage_monotonic: true
  nf_confluent: true

# Validation Rules
validation_rules:
  deterministic: "recompute AX from DOM must equal printed AX"
  monotone_staging: "only stages 1..k mounted, no hue before stage 7"
  nf_confluence: "any operator order rewrites to same NF_sig"
  local_contracts: "each operator honors its stage contracts"

# Hash Components
hash_components:
  nf_sig: "hash(normal_form_chain_applied)"
  stage_mask: "bitmask of mounted stages 1..8"
  operator_params: "parameters for each mounted operator"
